<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhishGuard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }

        h1 {
            color: #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 10px;
            text-align: left;
            border: 1px solid #ddd;
        }

        th {
            background-color: #f2f2f2;
        }

        a {
            text-decoration: none;
            color: #007BFF;
            margin-top: 20px;
            display: inline-block;
        }

        #chart {
            margin-top: 40px;
        }

        #scan-form {
            margin-bottom: 20px;
        }

        input[type="text"] {
            padding: 10px;
            width: 100%;
            margin: 5px 0;
        }

        button {
            padding: 10px 20px;
            background-color: #28a745;
            border: none;
            color: white;
            cursor: pointer;
        }

        button:hover {
            background-color: #218838;
        }

        .result {
            padding: 20px;
            border: 1px solid #ddd;
            margin-top: 20px;
        }

        .result p {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>PhishGuard</h1>

    <!-- Scan Form -->
    <div id="scan-form">
        <label for="email-text">Enter Email Text:</label>
        <input type="text" id="email-text" placeholder="Paste email content here">
        <button onclick="scanEmail()">Scan Email</button>
    </div>

    <div id="scan-result" class="result" style="display: none;">
        <p><strong>Prediction:</strong> <span id="prediction"></span></p>
        <p><strong>Confidence:</strong> <span id="confidence"></span></p>
        <p><strong>Flagged Words:</strong> <span id="flagged-words"></span></p>
        <p><strong>Links Found:</strong> <span id="links"></span></p>
    </div>

    <!-- Chart -->
    <div id="chart">
        <!-- Placeholder for the chart -->
    </div>

    <h2>Scan History</h2>
    <table>
        <thead>
            <tr>
                <th>Prediction</th>
                <th>Confidence</th>
                <th>Flagged Words</th>
                <th>Links</th>
            </tr>
        </thead>
        <tbody id="scan-history">
            <!-- Scan results will be appended here -->
        </tbody>
    </table>

    <script src="https://cdn.jsdelivr.net/npm/plotly.js"></script>
    <script>
        // Placeholder for scan history and chart
        let scanHistory = [];

        // Simulate backend scan for email
        function scanEmail() {
            const emailText = document.getElementById('email-text').value;
            if (!emailText.trim()) return;

            // Dummy scan result (replace with actual backend integration)
            const result = {
                prediction: Math.random() > 0.5 ? 'High ⚠️' : 'Low ✅',
                confidence: (Math.random() * 100).toFixed(2) + '%',
                flaggedWords: ['urgent', 'click', 'verify'],
                links: ['http://example.com', 'http://suspicious-link.com']
            };

            // Display scan result
            document.getElementById('prediction').innerText = result.prediction;
            document.getElementById('confidence').innerText = result.confidence;
            document.getElementById('flagged-words').innerText = result.flaggedWords.join(', ');
            document.getElementById('links').innerText = result.links.join(', ');

            document.getElementById('scan-result').style.display = 'block';

            // Add result to scan history
            scanHistory.push(result);
            updateScanHistory();
            updateChart();
        }

        // Update scan history table
        function updateScanHistory() {
            const historyTable = document.getElementById('scan-history');
            historyTable.innerHTML = '';

            scanHistory.forEach(result => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${result.prediction}</td>
                    <td>${result.confidence}</td>
                    <td>${result.flaggedWords.join(', ')}</td>
                    <td>${result.links.join(', ')}</td>
                `;
                historyTable.appendChild(row);
            });
        }

        // Update pie chart (for phishing vs safe emails)
        function updateChart() {
            const phishingCount = scanHistory.filter(result => result.prediction === 'High ⚠️').length;
            const safeCount = scanHistory.length - phishingCount;

            const data = [
                { label: 'Phishing', value: phishingCount },
                { label: 'Safe', value: safeCount }
            ];

            const layout = {
                title: 'Phishing vs Safe Emails',
                height: 400,
                width: 500
            };

            const chartData = [{
                values: data.map(d => d.value),
                labels: data.map(d => d.label),
                type: 'pie'
            }];

            Plotly.newPlot('chart', chartData, layout);
        }
    </script>
</body>
</html>
